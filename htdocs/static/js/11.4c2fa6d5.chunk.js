(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[11],{647:function(e,a,t){"use strict";t.r(a);var n=t(14),r=t(15),l=t(18),s=t(17),o=t(0),i=t.n(o),c=t(38),d=t(71),u=t(448),m=t(414),p=t(433),h=t(408),f=t(443),b=t.n(f),E=t(129),v=t(60),g=t(61),y=t(39),_=(t(444),t(445),t(130)),k=t(625),S=t(626),q=t(238),N=t(628),C=t(629),w=t(630),x=t(385),F=t(639),O=t(179),L=t(417),V=function(e){Object(l.a)(t,e);var a=Object(s.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return(e=a.call.apply(a,[this].concat(l))).translate=e.context.translate,e.animatedComponents=Object(m.a)(),e.state={form:new FormData,required_fields_hs:[],required_fields:[],required_fields_labels:[],editorState:h.EditorState.createEmpty(),isValid:!0,dropdowns:[],childrens:{},currentData:{}},e.getCurrentRecord=function(){var a=e.props.state.auth.login.userOauth;y.a.get("".concat(e.getPath(),"s/?case_number=").concat(e.props.location.state.item.model_id),{headers:{Authorization:"Bearer ".concat(a.access_token)}}).then((function(a){e.setState({currentData:a.data})}))},e.onEditorStateChange=function(a){e.setState({editorState:a})},e.renderForm=function(){var a=_.a.pages[e.props.path];return i.a.createElement(k.a,null,i.a.createElement(S.a,{md:"12"},i.a.createElement("h4",null,e.translate(a.verbose_name)),i.a.createElement("hr",null)),a.form.map((function(a){return e.renderSingleInput(a)})),i.a.createElement(S.a,{md:"12"},i.a.createElement("div",{className:"d-flex justify-content-between"},i.a.createElement("div",null),i.a.createElement(q.a.Ripple,{className:"square",color:"primary",type:"submit",onClick:function(a){return e.handleSubmit()}},e.translate("Submit")))))},e.checkboxValue=function(a){return"true"===e.state.form.get(a)},e.renderLabel=function(a){return!e.state.isValid&&e.state.required_fields_labels.includes(a.label)||!e.state.isValid&&e.state.required_fields.includes("".concat(a.name,"_id"))?i.a.createElement(N.a,{className:"text-danger"},i.a.createElement("strong",null,"* ",e.translate(a.label))):void 0!==a.bind&&!0===a.bind.required?e.state.required_fields_labels.includes(a.label)?i.a.createElement(N.a,{className:"text-danger"},i.a.createElement("strong",null," * ",e.translate(a.label))):i.a.createElement(N.a,null,i.a.createElement("strong",null,"* ",e.translate(a.label))):i.a.createElement(N.a,null,i.a.createElement("strong",null," ",e.translate(a.label)))},e.renderSingleInput=function(a){var t=i.a.createElement(i.a.Fragment,null);if(console.log(e.props.path),"case_number"===a.name||"created_by"===a.name||"othercategory"===a.name||"month"===a.name||"response"===a.name)return i.a.createElement("span",{key:a.name});switch(a.type){case"text":if("text"===a.name&&"article"===e.props.path)t=i.a.createElement(S.a,{md:"12",key:a.name},e.renderLabel(a),i.a.createElement(p.Editor,{wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",editorState:e.state.editorState,onEditorStateChange:e.onEditorStateChange,onChange:function(t){return e.updateState(a.name,b()(t))},toolbar:{options:["inline","blockType","fontSize","fontFamily","list","textAlign","colorPicker","link","embedded","emoji","image","remove","history"]}}));else{var n="text"===a.name?12:6;t=i.a.createElement(S.a,{md:n,key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"textarea",rows:7,className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}})))}break;case"binary":t=i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"file",className:"square",placeholder:e.translate(a.label),onChange:function(t){e.updateState(a.name,t.target.files[0])}})));break;case"string":var r,l;if(a["wq:ForeignKey"])t=i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(u.a,{isClearable:!0,className:"rounded-0",onChange:function(t){e.updateState("".concat(a.name,"_id"),null===t||void 0===t?void 0:t.value),a.children&&t&&e.updateChildrenList(a,t),a.children&&null===t&&e.clearChildrenList(a)},components:e.animatedComponents,options:e.selectOptions(void 0===a.has_parent?null!==(r=e.getForeignFieldDropdown(a["wq:ForeignKey"]))&&void 0!==r?r:[]:null!==(l=e.state.childrens[a["wq:ForeignKey"]])&&void 0!==l?l:[])})));else t=a.depends_on?e.checkboxValue(a.depends_on)?i.a.createElement(S.a,{md:"6",key:a.name},i.a.createElement(i.a.Fragment,null,e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"text",className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}})))):i.a.createElement("div",{key:a.name}):i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"text",className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}})));break;case"date":t=i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"date",className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}})));break;case"int":t=a.depends_on?e.checkboxValue(a.depends_on)?i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"number",className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}}))):i.a.createElement("div",{key:a.name}):i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(w.a,{type:"number",className:"square",placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}})));break;case"select one":if(a.has_boolean_options)t=a.depends_on?e.checkboxValue(a.depends_on)?i.a.createElement(S.a,{md:"6",key:a.name,className:"mb-1"},i.a.createElement(L.a,{color:"primary",className:"my-2",icon:i.a.createElement(O.a,{className:"vx-icon",size:16}),label:i.a.createElement("strong",null,e.translate(a.label)),defaultChecked:!1,onChange:function(t){return e.updateState(a.name,!e.checkboxValue(a.name))}})):i.a.createElement(S.a,{md:"6",key:a.name}):i.a.createElement(S.a,{md:"6",key:a.name,className:"mb-1"},i.a.createElement(L.a,{color:"primary",className:"my-2",icon:i.a.createElement(O.a,{className:"vx-icon",size:16}),label:i.a.createElement("strong",null,e.translate(a.label)),defaultChecked:!1,onChange:function(t){return e.updateState(a.name,!e.checkboxValue(a.name))}}));else if(a.depend_on_value){if(!a.depend_on_value.value.includes(e.state.form.get("".concat(a.depend_on_value.field,"_id"))))return i.a.createElement(S.a,{md:"6",key:a.name});t=t=i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(x.a,{className:"square",type:"select",id:a.name,placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}},i.a.createElement("option",null,e.translate("Select")),e.renderSelectOption(a.choices))))}else t=a.depends_on?e.checkboxValue(a.depends_on)?i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(x.a,{className:"square",type:"select",id:a.name,placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}},i.a.createElement("option",null,e.translate("Select")),e.renderSelectOption(a.choices)))):i.a.createElement(S.a,{md:"6",key:a.name}):i.a.createElement(S.a,{md:"6",key:a.name},e.renderLabel(a),i.a.createElement(C.a,{className:"form-label-group position-relative has-icon-left"},i.a.createElement(x.a,{className:"square",type:"select",id:a.name,placeholder:e.translate(a.label),onChange:function(t){return e.updateState(a.name,t.target.value)}},i.a.createElement("option",null,e.translate("Select")),e.renderSelectOption(a.choices))));break;default:t=i.a.createElement("div",{key:a.name})}return t},e.renderSelectOption=function(a){return a.map((function(a){return i.a.createElement("option",{key:a.name,value:a.name},e.translate(a.label))}))},e.renderSelectOptionForeignWQ=function(a){return a.map((function(a){return i.a.createElement("option",{key:a.id,value:a.id},e.translate(a.label))}))},e.getForeignFieldDropdown=function(a){var t;return null!==(t=e.props.app_reducer.dropdowns[a])&&void 0!==t?t:[]},e.updateState=function(a,t){var n=e.state.form;(""!==t||t)&&(n.has(a)?n.set(a,t):n.append(a,t),e.removeFromRequired(a)),!t&&n.has(a)&&(n.delete(a),e.state.required_fields_hs.includes(a)&&e.addFromRequired(a)),e.setState({form:n})},e.updateChildrenList=function(a,t){var n=e.state.childrens,r=[];a.has_parent?(r=e.state.childrens[a["wq:ForeignKey"]].filter((function(e){return Number(e.id)===Number(t.value)})),n[a.children]=r[0]["".concat(a.children,"_set")],e.setState({childrens:n})):(r=e.props.app_reducer.dropdowns[a["wq:ForeignKey"]].filter((function(e){return Number(e.id)===Number(t.value)})),n[a.children]=r[0]["".concat(a.children,"_set")],e.setState({childrens:n}))},e.clearChildrenList=function(a){var t=e.state.childrens;t[a.children]=[],e.updateState("".concat(a.children,"_id"),""),e.setState({childrens:t})},e.selectOptions=function(a){return a.map((function(a){return{value:a.id,label:e.translate(a.label),color:"#4287f5"}}))},e.handleSubmit=function(){var a=e.props.state.auth.login.userOauth;if(e.state.required_fields.length>0)e.notifyErrorBounce("Fill all required inputs"),e.setState({isValid:!1});else{e.setState({isValid:!0});var t="customuser"===e.props.path?"user":e.props.path;y.a.post("".concat(t,"s.json"),e.state.form,{headers:{Authorization:"Bearer ".concat(a.access_token)}}).then((function(a){var t=a.data;e.notifySuccessBounce(t.id),setTimeout((function(){g.a.push("/".concat(e.props.url))}),1e3)})).catch((function(a){a.error;e.notifyErrorBounce("Failed to save Object.")}))}},e.animatedComponents=Object(m.a)(),e.notifySuccessBounce=function(){return d.c.success(e.translate("Transaction completed successfuly!"),{transition:d.a})},e.notifyErrorBounce=function(a){return d.c.error(e.translate(a),{transition:d.a})},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getCurrentRecord(),console.log("ITEM: ",this.props.location.state.item),this.props.requestDropodowns(),_.a.pages[this.getPath()].form.forEach((function(a,t){e.addToRequired(a)}));var a=this.props.app_reducer.dropdowns;this.setState({dropdowns:a})}},{key:"getPath",value:function(){var e="lvform";switch(this.props.location.state.item.title){case"New Task":return"task";case"New Article":return"article";default:e="lvform"}return e}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(F.a,{className:"rounded-0 mb-0 px-2"}))}},{key:"addToRequired",value:function(e){var a=this.state.required_fields.indexOf(e.name);if(void 0!==e.children){var t=this.state.childrens;t[e.children]=[],this.setState({childrens:t})}void 0!==e.bind&&!0===e.bind.required&&a<=0&&("string"===e.type&&e["wq:ForeignKey"]?(this.state.required_fields.push("".concat(e.name,"_id")),this.state.required_fields_hs.push("".concat(e.name,"_id"))):(this.state.required_fields.push(e.name),this.state.required_fields_hs.push(e.name)),this.state.required_fields_labels.push(e.label))}},{key:"removeFromRequired",value:function(e){var a=this.state.required_fields.indexOf(e);a>=0&&(this.state.required_fields.splice(a,1),this.state.required_fields_labels.splice(a,1))}},{key:"addFromRequired",value:function(e){this.state.required_fields.push(e)}}]),t}(i.a.Component);V.contextType=v.a,a.default=Object(c.b)((function(e){return{state:e,app_reducer:e.app.app_reducer}}),{requestDropodowns:E.b})(V)}}]);
//# sourceMappingURL=11.4c2fa6d5.chunk.js.map